!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=6)}([function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}e.exports=function(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}},function(e,t,n){var o,i;!function(r,a,s){"use strict";"undefined"!=typeof window&&n(5)?void 0===(i="function"==typeof(o=s)?o.call(t,n,t,e):o)||(e.exports=i):e.exports?e.exports=s():a.exports?a.exports=s():a.Fingerprint2=s()}(0,this,(function(){"use strict";var e=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]+t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]+t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]+t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]+t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},t=function(e,t){e=[e[0]>>>16,65535&e[0],e[1]>>>16,65535&e[1]],t=[t[0]>>>16,65535&t[0],t[1]>>>16,65535&t[1]];var n=[0,0,0,0];return n[3]+=e[3]*t[3],n[2]+=n[3]>>>16,n[3]&=65535,n[2]+=e[2]*t[3],n[1]+=n[2]>>>16,n[2]&=65535,n[2]+=e[3]*t[2],n[1]+=n[2]>>>16,n[2]&=65535,n[1]+=e[1]*t[3],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[2]*t[2],n[0]+=n[1]>>>16,n[1]&=65535,n[1]+=e[3]*t[1],n[0]+=n[1]>>>16,n[1]&=65535,n[0]+=e[0]*t[3]+e[1]*t[2]+e[2]*t[1]+e[3]*t[0],n[0]&=65535,[n[0]<<16|n[1],n[2]<<16|n[3]]},n=function(e,t){return 32===(t%=64)?[e[1],e[0]]:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t|e[0]>>>32-t]:(t-=32,[e[1]<<t|e[0]>>>32-t,e[0]<<t|e[1]>>>32-t])},o=function(e,t){return 0===(t%=64)?e:t<32?[e[0]<<t|e[1]>>>32-t,e[1]<<t]:[e[1]<<t-32,0]},i=function(e,t){return[e[0]^t[0],e[1]^t[1]]},r=function(e){return e=i(e,[0,e[0]>>>1]),e=t(e,[4283543511,3981806797]),e=i(e,[0,e[0]>>>1]),e=t(e,[3301882366,444984403]),e=i(e,[0,e[0]>>>1])},a=function(a,s){s=s||0;for(var c=(a=a||"").length%16,u=a.length-c,l=[0,s],d=[0,s],h=[0,0],p=[0,0],m=[2277735313,289559509],f=[1291169091,658871167],g=0;g<u;g+=16)h=[255&a.charCodeAt(g+4)|(255&a.charCodeAt(g+5))<<8|(255&a.charCodeAt(g+6))<<16|(255&a.charCodeAt(g+7))<<24,255&a.charCodeAt(g)|(255&a.charCodeAt(g+1))<<8|(255&a.charCodeAt(g+2))<<16|(255&a.charCodeAt(g+3))<<24],p=[255&a.charCodeAt(g+12)|(255&a.charCodeAt(g+13))<<8|(255&a.charCodeAt(g+14))<<16|(255&a.charCodeAt(g+15))<<24,255&a.charCodeAt(g+8)|(255&a.charCodeAt(g+9))<<8|(255&a.charCodeAt(g+10))<<16|(255&a.charCodeAt(g+11))<<24],h=t(h,m),h=n(h,31),h=t(h,f),l=i(l,h),l=n(l,27),l=e(l,d),l=e(t(l,[0,5]),[0,1390208809]),p=t(p,f),p=n(p,33),p=t(p,m),d=i(d,p),d=n(d,31),d=e(d,l),d=e(t(d,[0,5]),[0,944331445]);switch(h=[0,0],p=[0,0],c){case 15:p=i(p,o([0,a.charCodeAt(g+14)],48));case 14:p=i(p,o([0,a.charCodeAt(g+13)],40));case 13:p=i(p,o([0,a.charCodeAt(g+12)],32));case 12:p=i(p,o([0,a.charCodeAt(g+11)],24));case 11:p=i(p,o([0,a.charCodeAt(g+10)],16));case 10:p=i(p,o([0,a.charCodeAt(g+9)],8));case 9:p=i(p,[0,a.charCodeAt(g+8)]),p=t(p,f),p=n(p,33),p=t(p,m),d=i(d,p);case 8:h=i(h,o([0,a.charCodeAt(g+7)],56));case 7:h=i(h,o([0,a.charCodeAt(g+6)],48));case 6:h=i(h,o([0,a.charCodeAt(g+5)],40));case 5:h=i(h,o([0,a.charCodeAt(g+4)],32));case 4:h=i(h,o([0,a.charCodeAt(g+3)],24));case 3:h=i(h,o([0,a.charCodeAt(g+2)],16));case 2:h=i(h,o([0,a.charCodeAt(g+1)],8));case 1:h=i(h,[0,a.charCodeAt(g)]),h=t(h,m),h=n(h,31),h=t(h,f),l=i(l,h)}return l=i(l,[0,a.length]),d=i(d,[0,a.length]),l=e(l,d),d=e(d,l),l=r(l),d=r(d),l=e(l,d),d=e(d,l),("00000000"+(l[0]>>>0).toString(16)).slice(-8)+("00000000"+(l[1]>>>0).toString(16)).slice(-8)+("00000000"+(d[0]>>>0).toString(16)).slice(-8)+("00000000"+(d[1]>>>0).toString(16)).slice(-8)},s={preprocessor:null,audio:{timeout:1e3,excludeIOS11:!0},fonts:{swfContainerId:"fingerprintjs2",swfPath:"flash/compiled/FontList.swf",userDefinedFonts:[],extendedJsFonts:!1},screen:{detectScreenOrientation:!0},plugins:{sortPluginsFor:[/palemoon/i],excludeIE:!1},extraComponents:[],excludes:{enumerateDevices:!0,pixelRatio:!0,doNotTrack:!0,fontsFlash:!0},NOT_AVAILABLE:"not available",ERROR:"error",EXCLUDED:"excluded"},c=function(e,t){if(Array.prototype.forEach&&e.forEach===Array.prototype.forEach)e.forEach(t);else if(e.length===+e.length)for(var n=0,o=e.length;n<o;n++)t(e[n],n,e);else for(var i in e)e.hasOwnProperty(i)&&t(e[i],i,e)},u=function(e,t){var n=[];return null==e?n:Array.prototype.map&&e.map===Array.prototype.map?e.map(t):(c(e,(function(e,o,i){n.push(t(e,o,i))})),n)},l=function(){return navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices},d=function(e){var t=[window.screen.width,window.screen.height];return e.screen.detectScreenOrientation&&t.sort().reverse(),t},h=function(e){if(window.screen.availWidth&&window.screen.availHeight){var t=[window.screen.availHeight,window.screen.availWidth];return e.screen.detectScreenOrientation&&t.sort().reverse(),t}return e.NOT_AVAILABLE},p=function(e){return navigator.hardwareConcurrency?navigator.hardwareConcurrency:e.NOT_AVAILABLE},m=function(e){return navigator.cpuClass||e.NOT_AVAILABLE},f=function(e){return navigator.platform?navigator.platform:e.NOT_AVAILABLE},g=function(e){return navigator.doNotTrack?navigator.doNotTrack:navigator.msDoNotTrack?navigator.msDoNotTrack:window.doNotTrack?window.doNotTrack:e.NOT_AVAILABLE},v=function(e){var t=[],n=document.createElement("canvas");n.width=2e3,n.height=200,n.style.display="inline";var o=n.getContext("2d");return o.rect(0,0,10,10),o.rect(2,2,6,6),t.push("canvas winding:"+(!1===o.isPointInPath(5,5,"evenodd")?"yes":"no")),o.textBaseline="alphabetic",o.fillStyle="#f60",o.fillRect(125,1,62,20),o.fillStyle="#069",e.dontUseFakeFontInCanvas?o.font="11pt Arial":o.font="11pt no-real-font-123",o.fillText("Cwm fjordbank glyphs vext quiz, 😃",2,15),o.fillStyle="rgba(102, 204, 0, 0.2)",o.font="18pt Arial",o.fillText("Cwm fjordbank glyphs vext quiz, 😃",4,45),o.globalCompositeOperation="multiply",o.fillStyle="rgb(255,0,255)",o.beginPath(),o.arc(50,50,50,0,2*Math.PI,!0),o.closePath(),o.fill(),o.fillStyle="rgb(0,255,255)",o.beginPath(),o.arc(100,50,50,0,2*Math.PI,!0),o.closePath(),o.fill(),o.fillStyle="rgb(255,255,0)",o.beginPath(),o.arc(75,100,50,0,2*Math.PI,!0),o.closePath(),o.fill(),o.fillStyle="rgb(255,0,255)",o.arc(75,75,75,0,2*Math.PI,!0),o.arc(75,75,25,0,2*Math.PI,!0),o.fill("evenodd"),n.toDataURL&&t.push("canvas fp:"+n.toDataURL()),t},w=function(){var e,t=function(t){return e.clearColor(0,0,0,1),e.enable(e.DEPTH_TEST),e.depthFunc(e.LEQUAL),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT),"["+t[0]+", "+t[1]+"]"};if(!(e=T()))return null;var n=[],o=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,o);var i=new Float32Array([-.2,-.9,0,.4,-.26,0,0,.732134444,0]);e.bufferData(e.ARRAY_BUFFER,i,e.STATIC_DRAW),o.itemSize=3,o.numItems=3;var r=e.createProgram(),a=e.createShader(e.VERTEX_SHADER);e.shaderSource(a,"attribute vec2 attrVertex;varying vec2 varyinTexCoordinate;uniform vec2 uniformOffset;void main(){varyinTexCoordinate=attrVertex+uniformOffset;gl_Position=vec4(attrVertex,0,1);}"),e.compileShader(a);var s=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(s,"precision mediump float;varying vec2 varyinTexCoordinate;void main() {gl_FragColor=vec4(varyinTexCoordinate,0,1);}"),e.compileShader(s),e.attachShader(r,a),e.attachShader(r,s),e.linkProgram(r),e.useProgram(r),r.vertexPosAttrib=e.getAttribLocation(r,"attrVertex"),r.offsetUniform=e.getUniformLocation(r,"uniformOffset"),e.enableVertexAttribArray(r.vertexPosArray),e.vertexAttribPointer(r.vertexPosAttrib,o.itemSize,e.FLOAT,!1,0,0),e.uniform2f(r.offsetUniform,1,1),e.drawArrays(e.TRIANGLE_STRIP,0,o.numItems);try{n.push(e.canvas.toDataURL())}catch(e){}n.push("extensions:"+(e.getSupportedExtensions()||[]).join(";")),n.push("webgl aliased line width range:"+t(e.getParameter(e.ALIASED_LINE_WIDTH_RANGE))),n.push("webgl aliased point size range:"+t(e.getParameter(e.ALIASED_POINT_SIZE_RANGE))),n.push("webgl alpha bits:"+e.getParameter(e.ALPHA_BITS)),n.push("webgl antialiasing:"+(e.getContextAttributes().antialias?"yes":"no")),n.push("webgl blue bits:"+e.getParameter(e.BLUE_BITS)),n.push("webgl depth bits:"+e.getParameter(e.DEPTH_BITS)),n.push("webgl green bits:"+e.getParameter(e.GREEN_BITS)),n.push("webgl max anisotropy:"+function(e){var t=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic");if(t){var n=e.getParameter(t.MAX_TEXTURE_MAX_ANISOTROPY_EXT);return 0===n&&(n=2),n}return null}(e)),n.push("webgl max combined texture image units:"+e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS)),n.push("webgl max cube map texture size:"+e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE)),n.push("webgl max fragment uniform vectors:"+e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS)),n.push("webgl max render buffer size:"+e.getParameter(e.MAX_RENDERBUFFER_SIZE)),n.push("webgl max texture image units:"+e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)),n.push("webgl max texture size:"+e.getParameter(e.MAX_TEXTURE_SIZE)),n.push("webgl max varying vectors:"+e.getParameter(e.MAX_VARYING_VECTORS)),n.push("webgl max vertex attribs:"+e.getParameter(e.MAX_VERTEX_ATTRIBS)),n.push("webgl max vertex texture image units:"+e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS)),n.push("webgl max vertex uniform vectors:"+e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS)),n.push("webgl max viewport dims:"+t(e.getParameter(e.MAX_VIEWPORT_DIMS))),n.push("webgl red bits:"+e.getParameter(e.RED_BITS)),n.push("webgl renderer:"+e.getParameter(e.RENDERER)),n.push("webgl shading language version:"+e.getParameter(e.SHADING_LANGUAGE_VERSION)),n.push("webgl stencil bits:"+e.getParameter(e.STENCIL_BITS)),n.push("webgl vendor:"+e.getParameter(e.VENDOR)),n.push("webgl version:"+e.getParameter(e.VERSION));try{var u=e.getExtension("WEBGL_debug_renderer_info");u&&(n.push("webgl unmasked vendor:"+e.getParameter(u.UNMASKED_VENDOR_WEBGL)),n.push("webgl unmasked renderer:"+e.getParameter(u.UNMASKED_RENDERER_WEBGL)))}catch(e){}return e.getShaderPrecisionFormat?(c(["FLOAT","INT"],(function(t){c(["VERTEX","FRAGMENT"],(function(o){c(["HIGH","MEDIUM","LOW"],(function(i){c(["precision","rangeMin","rangeMax"],(function(r){var a=e.getShaderPrecisionFormat(e[o+"_SHADER"],e[i+"_"+t])[r];"precision"!==r&&(r="precision "+r);var s=["webgl ",o.toLowerCase()," shader ",i.toLowerCase()," ",t.toLowerCase()," ",r,":",a].join("");n.push(s)}))}))}))})),n):n},y=function(){var e=document.createElement("div");e.innerHTML="&nbsp;",e.className="adsbox";var t=!1;try{document.body.appendChild(e),t=0===document.getElementsByClassName("adsbox")[0].offsetHeight,document.body.removeChild(e)}catch(e){t=!1}return t},k=function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))},b=function(){if(!k())return!1;var e=T();return!!window.WebGLRenderingContext&&!!e},A=function(){return void 0!==window.swfobject},_=function(){return window.swfobject.hasFlashPlayerVersion("9.0.0")},C=function(e,t){window.___fp_swf_loaded=function(t){e(t)};var n=t.fonts.swfContainerId;!function(e){var t=document.createElement("div");t.setAttribute("id",e.fonts.swfContainerId),document.body.appendChild(t)}();var o={onReady:"___fp_swf_loaded"};window.swfobject.embedSWF(t.fonts.swfPath,n,"1","1","9.0.0",!1,o,{allowScriptAccess:"always",menu:"false"},{})},T=function(){var e=document.createElement("canvas"),t=null;try{t=e.getContext("webgl")||e.getContext("experimental-webgl")}catch(e){}return t||(t=null),t},S=[{key:"userAgent",getData:function(e){e(navigator.userAgent)}},{key:"language",getData:function(e,t){e(navigator.language||navigator.userLanguage||navigator.browserLanguage||navigator.systemLanguage||t.NOT_AVAILABLE)}},{key:"colorDepth",getData:function(e,t){e(window.screen.colorDepth||t.NOT_AVAILABLE)}},{key:"deviceMemory",getData:function(e,t){e(navigator.deviceMemory||t.NOT_AVAILABLE)}},{key:"pixelRatio",getData:function(e,t){e(window.devicePixelRatio||t.NOT_AVAILABLE)}},{key:"hardwareConcurrency",getData:function(e,t){e(p(t))}},{key:"screenResolution",getData:function(e,t){e(d(t))}},{key:"availableScreenResolution",getData:function(e,t){e(h(t))}},{key:"timezoneOffset",getData:function(e){e((new Date).getTimezoneOffset())}},{key:"timezone",getData:function(e,t){window.Intl&&window.Intl.DateTimeFormat?e((new window.Intl.DateTimeFormat).resolvedOptions().timeZone):e(t.NOT_AVAILABLE)}},{key:"openDatabase",getData:function(e){e(!!window.openDatabase)}},{key:"cpuClass",getData:function(e,t){e(m(t))}},{key:"platform",getData:function(e,t){e(f(t))}},{key:"doNotTrack",getData:function(e,t){e(g(t))}},{key:"canvas",getData:function(e,t){k()?e(v(t)):e(t.NOT_AVAILABLE)}},{key:"webgl",getData:function(e,t){b()?e(w()):e(t.NOT_AVAILABLE)}},{key:"adBlock",getData:function(e){e(y())}},{key:"fontsFlash",getData:function(e,t){return A()?_()?t.fonts.swfPath?void C((function(t){e(t)}),t):e("missing options.fonts.swfPath"):e("flash not installed"):e("swf object not loaded")},pauseBefore:!0},{key:"audio",getData:function(e,t){var n=t.audio;if(n.excludeIOS11&&navigator.userAgent.match(/OS 11.+Version\/11.+Safari/))return e(t.EXCLUDED);var o=window.OfflineAudioContext||window.webkitOfflineAudioContext;if(null==o)return e(t.NOT_AVAILABLE);var i=new o(1,44100,44100),r=i.createOscillator();r.type="triangle",r.frequency.setValueAtTime(1e4,i.currentTime);var a=i.createDynamicsCompressor();c([["threshold",-50],["knee",40],["ratio",12],["reduction",-20],["attack",0],["release",.25]],(function(e){void 0!==a[e[0]]&&"function"==typeof a[e[0]].setValueAtTime&&a[e[0]].setValueAtTime(e[1],i.currentTime)})),r.connect(a),a.connect(i.destination),r.start(0),i.startRendering();var s=setTimeout((function(){return console.warn('Audio fingerprint timed out. Please report bug at https://github.com/Valve/fingerprintjs2 with your user agent: "'+navigator.userAgent+'".'),i.oncomplete=function(){},i=null,e("audioTimeout")}),n.timeout);i.oncomplete=function(t){var n;try{clearTimeout(s),n=t.renderedBuffer.getChannelData(0).slice(4500,5e3).reduce((function(e,t){return e+Math.abs(t)}),0).toString(),r.disconnect(),a.disconnect()}catch(t){return void e(t)}e(n)}}},{key:"enumerateDevices",getData:function(e,t){if(!l())return e(t.NOT_AVAILABLE);navigator.mediaDevices.enumerateDevices().then((function(t){e(t.map((function(e){return"id="+e.deviceId+";gid="+e.groupId+";"+e.kind+";"+e.label})))})).catch((function(t){e(t)}))}}],P=function(e){throw new Error("'new Fingerprint()' is deprecated, see https://github.com/Valve/fingerprintjs2#upgrade-guide-from-182-to-200")};return P.get=function(e,t){t?e||(e={}):(t=e,e={}),function(e,t){if(null==t)return e;var n,o;for(o in t)null==(n=t[o])||Object.prototype.hasOwnProperty.call(e,o)||(e[o]=n)}(e,s),e.components=e.extraComponents.concat(S);var n={data:[],addPreprocessedComponent:function(t,o){"function"==typeof e.preprocessor&&(o=e.preprocessor(t,o)),n.data.push({key:t,value:o})}},o=-1;!function i(r){if((o+=1)>=e.components.length)t(n.data);else{var a=e.components[o];if(e.excludes[a.key])i(!1);else{if(!r&&a.pauseBefore)return o-=1,void setTimeout((function(){i(!0)}),1);try{a.getData((function(e){n.addPreprocessedComponent(a.key,e),i(!1)}),e)}catch(e){n.addPreprocessedComponent(a.key,String(e)),i(!1)}}}}(!1)},P.getPromise=function(e){return new Promise((function(t,n){P.get(e,t)}))},P.getV18=function(e,t){return null==t&&(t=e,e={}),P.get(e,(function(n){for(var o=[],i=0;i<n.length;i++){var r=n[i];r.value===(e.NOT_AVAILABLE||"not available")?o.push({key:r.key,value:"unknown"}):"plugins"===r.key?o.push({key:"plugins",value:u(r.value,(function(e){var t=u(e[2],(function(e){return e.join?e.join("~"):e})).join(",");return[e[0],e[1],t].join("::")}))}):-1!==["canvas","webgl"].indexOf(r.key)?o.push({key:r.key,value:r.value.join("~")}):r.value?o.push(r.value.join?{key:r.key,value:r.value.join(";")}:r):o.push({key:r.key,value:r.value})}var s=a(u(o,(function(e){return e.value})).join("~~~"),31);t(s,o)}))},P.x64hash128=a,P.VERSION="2.1.0",P}))},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){"use strict";n.r(t);var o=n(3),i=n.n(o),r=n(0),a=n.n(r),s=n(1),c=n.n(s),u=new(function(){function e(){a()(this,e)}return c()(e,[{key:"getScreenResolution",value:function(){var e,t=window.screen;"number"==typeof t.width&&"number"==typeof t.height||(t={width:window.screen.availHeight||window.innerWidth||document.body.offsetWidth||document.body.clientWidth,height:window.screen.availHeight||window.innerHeight||document.body.offsetHeight||document.body.clientHeight}),e=window.devicePixelRatio||1,e=Math.max(2,e),t.width>=1080&&(e=1);var n=t.width*e,o=t.height*e;return{width:n=parseInt(n),height:o=parseInt(o)}}}]),e}()),l=window.navigator.userAgent,d=[{value:"android",key:"Android"},{value:"webos",key:"hpwOS"},{value:"ios",key:"iPhone OS"},{value:"linux",key:"Linux"},{value:"windows",key:"Windows NT"},{value:"mac",key:"Macintosh"},{value:"ipad",key:"iPad; CPU OS"},{value:"osx",key:"Mac OS X"},{value:"ubuntu",key:"Ubuntu"},{value:"mobile",key:"Mobile"}],h="("+d.map((function(e){return e.key})).join("|")+")[\\s\\/]*([\\d\\_\\.]*)",p=new(function(){function e(){a()(this,e),this.exportOsInfo()}return c()(e,[{key:"exportOsInfo",value:function(){var e=this,t=l.match(new RegExp(h,"g"))||[];d.forEach((function(n){t.forEach((function(t){var o=t.match(new RegExp(h)),i=n.value,r=[0];o&&o[1]===n.key?(r=(r=o[2]?o[2].split(/[_\.]/):r).map((function(e){return parseInt(e)})),e[i]=!0,e[i+"Version"]=r):void 0===e[i]&&(e[i]=!1,e[i+"Version"]=r)}))})),this.ipad&&(this.iosVersion=this.ipadVersion),this.ios=this.ios||this.ipad,this.osx=this.osx&&this.mac,this.desktop=this.windows||this.mac||this.ubuntu||this.linux&&!this.android&&!this.mobile,this.mobile=this.mobile||this.android||this.ios}}]),e}()),m=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";a()(this,e);var n=t.match(/(\w+):\/\/([^:\/\?]*):?(\d*)([^\?]*)\??([^#$]*)#?([^#]*)/)||[];this.scheme=n[1]||"",this.protocol=n[1]||"",this.domain=n[2]||"",this.host=n[2]||"",this.port=n[3]||"",this.path=n[4]||"",this.queryString=n[5]||"",this.search=n[5]||"",this.hash=n[6]||""}return c()(e,[{key:"getParams",value:function(){var e=this.queryString.split("&"),t={};return e.forEach((function(e){var n=e.split("=");n[0]&&(t[n[0]]=n[1])})),t}},{key:"getParamsStartWith",value:function(e){var t=new RegExp("^"+e),n=this.getParams(),o={};for(var i in n)t.test(i)&&("mw_cp_"===e||"mw_dynp_"===e?o[i.replace(e,"")]=n[i]:o[i]=n[i]);return o}},{key:"getParam",value:function(e){return this.getParams()[e]}},{key:"setParam",value:function(e,t){var n=this.getParams(),o=[];for(var i in void 0===t?delete n[e]:n[e]=t,n)o.push(i+"="+n[i]);return this.queryString=o.join("&"),this}},{key:"setParams",value:function(e){var t=this.getParams(),n=[];for(var o in e)null===t[o]?delete t[o]:t[o]=e[o];for(var i in t)n.push(i+"="+t[i]);return this.queryString=n.join("&"),this}},{key:"toString",value:function(){var e=[];return e.push(this.scheme?this.scheme+"://":""),e.push(this.host),e.push(this.port?":"+this.port:""),e.push(this.path),e.push(this.queryString?"?"+this.queryString:""),e.push(this.hash?"#"+this.hash:""),e.join("")}}]),e}(),f=window.navigator.userAgent,g=[{key:"Chrome",value:"chrome"},{key:"CriOS",value:"CriOS",unambiguous:!0},{key:"AppleWebkit",value:"webkit"},{key:"AppleWebKit",value:"webkit"},{key:"Safari",value:"safari"},{key:"Opera",value:"opera",unambiguous:!0},{key:"Firefox",value:"firefox",unambiguous:!0},{key:"Firefox",value:"firefox",unambiguous:!0},{key:"FxiOS",value:"fxios",unambiguous:!0},{key:"MQQBrowser",value:"qqbrowser",unambiguous:!0},{key:"QQ",value:"qq",unambiguous:!0},{key:"Qzone",value:"qzone",unambiguous:!0},{key:"Maxthon",value:"maxthon",unambiguous:!0},{key:"UCWEB",value:"ucweb",unambiguous:!0},{key:"SogouMobileBrowser",value:"sogou",unambiguous:!0},{key:"UCBrowser",value:"uc",unambiguous:!0},{key:"SE",value:"se",unambiguous:!0},{key:"360SE",value:"360se",unambiguous:!0},{key:"IEMobile",value:"iem",unambiguous:!0},{key:"MSIE",value:"ie",unambiguous:!0},{key:"weibo",value:"weibo",unambiguous:!0},{key:"MagicWindow",value:"mw",unambiguous:!0},{key:"SamsungBrowser",value:"samsung"},{key:"QHBrowser",value:"qh360",unambiguous:!0},{key:"Mb2345Browser",value:"mb2345",unambiguous:!0},{key:"TencentTraveler",value:"tt",unambiguous:!0},{key:"MxBrowser",value:"mx",unambiguous:!0},{key:"BAIDUBrowser",value:"baidu",unambiguous:!0},{key:"baidubrowser",value:"baidu",unambiguous:!0},{key:"MicroMessenger",value:"wx",unambiguous:!0},{key:"LieBaoFast",value:"liebao",unambiguous:!0},{key:"AlipayClient",value:"aliPay",unambiguous:!0},{key:"Huawei",value:"huawei",unambiguous:!0}],v="("+g.map((function(e){return e.key})).join("|")+")[\\s_{3}\\/]*([\\d\\_\\.]*)",w=new(function(){function e(){var t=this;a()(this,e);var n=f.match(new RegExp(v,"g"))||[];g.forEach((function(e){n.forEach((function(n){var o,i=n.match(new RegExp(v)),r=e.value;i&&i[1]===e.key?(o=(o=(o=(o=i[2]||"").replace(/(^[\._\/]*|[\._\/]*$)/g,""))?o.split(/[_\.]/):[0]).map((function(e){return parseInt(e)})),t[r]=!0,t[r+"Version"]=o,!0===e.unambiguous&&void 0===t.unambiguous&&(t.unambiguous=!0)):void 0===t[r]&&(t[r+"Version"]=[0])}))}));var o=this.unambiguous;this.chrome=this.chrome||this.CriOS,this.chrome=this.chrome&&-1!==navigator.vendor.indexOf("Google")&&window.chrome,this.chrome=this.chrome&&!o,this.chrome=!!this.chrome,this.safari=this.safari&&-1!==navigator.vendor.indexOf("Apple"),this.safari=this.safari&&(p.ios||p.osx),this.safari=this.safari&&!this.chrome&&!o,this.safari=!!this.safari,this.iosWebView=p.ios&&this.webkit&&!this.unambiguous&&!this.safari&&!this.chrome,this.androidWebView=p.android&&this.webkit&&!this.unambiguous&&!this.chrome,this.wx&&(this.qqbrowser=!1,this.qqbrowserVersion=[]),this.qzone&&(this.qq=!1)}return c()(e,[{key:"isSupportedScheme",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"auto";return"auto"===t?this.isSupportedSchemeAuto(e):this.isSupportedSchemeClick(e)}},{key:"isSupportedSchemeAuto",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return!u.smnote4&&(!this.weibo&&(!((this.wx||this.qq)&&!this.isSupportedYYB(e))&&!1!==e.isSupportedScheme))}},{key:"isSupportedSchemeClick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.isSupportedSchemeAuto(e)||this.isSupportedSchemeOnlyClick(e),!1}},{key:"isSupportedSchemeOnlyClick",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this.qq&&this.qqVersion[0]>=6;return!!(p.android&&e.isSupportedSchemeClick||this.chrome||t||this.aliPay||this.baidu||this.qqbrowser)}},{key:"isSupportedSchemeOnlyHref",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e.isSupportedSchemeClick)return!1;if(p.ios){if(this.qq&&this.qqVersion[0]>=6)return!0}else if(this.SamsungBrowser)return!0;return!1}},{key:"isSupportedUniversalLink",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(p.ios&&p.iosVersion[0]>=9&&e.iosUniversalLinkEnabled){return p.iosVersion[0]>=10?this.weibo||this.wx||this.safari||this.aliPay||!this.unambiguous:this.weibo||this.wx||this.safari||this.aliPay}return!1}},{key:"isSupportedAppLink",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!1}},{key:"isSupportedYYB",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=new m(t);if("dc"===n.getParam("mw_dc_order"))return!1;var o=p.ios?e.iosYyb:e.androidYyb,i=p.ios&&this.qzone,r=this.wx&&(p.iosVersion[0]>=9&&!e.iosUniversalLinkEnabled||p.iosVersion[0]<9)||i;return o&&r}},{key:"isSupportedIntent",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];return!1}}]),e}()),y=function(){var e;new m(document.location.href).getParam("mw_debug")&&(e=console).log.apply(e,arguments)},k={sha1:function(e){var t,n,o,i,r,a,s,c,u,l,d=function(e,t){return e<<t|e>>>32-t},h=function(e){var t,n="";for(t=7;t>=0;t--)n+=(e>>>4*t&15).toString(16);return n},p=[],m=1732584193,f=4023233417,g=2562383102,v=271733878,w=3285377520,y=[];for(l=(e=this.utf8_encode(e)).length,n=0;n<l-3;n+=4)o=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),y.push(o);switch(3&l){case 0:n=2147483648;break;case 1:n=e.charCodeAt(l-1)<<24|8388608;break;case 2:n=e.charCodeAt(l-2)<<24|e.charCodeAt(l-1)<<16|32768;break;case 3:n=e.charCodeAt(l-3)<<24|e.charCodeAt(l-2)<<16|e.charCodeAt(l-1)<<8|128}for(y.push(n);14!=(15&y.length);)y.push(0);for(y.push(l>>>29),y.push(l<<3&4294967295),t=0;t<y.length;t+=16){for(n=0;n<16;n++)p[n]=y[t+n];for(n=16;n<=79;n++)p[n]=d(p[n-3]^p[n-8]^p[n-14]^p[n-16],1);for(i=m,r=f,a=g,s=v,c=w,n=0;n<=19;n++)u=d(i,5)+(r&a|~r&s)+c+p[n]+1518500249&4294967295,c=s,s=a,a=d(r,30),r=i,i=u;for(n=20;n<=39;n++)u=d(i,5)+(r^a^s)+c+p[n]+1859775393&4294967295,c=s,s=a,a=d(r,30),r=i,i=u;for(n=40;n<=59;n++)u=d(i,5)+(r&a|r&s|a&s)+c+p[n]+2400959708&4294967295,c=s,s=a,a=d(r,30),r=i,i=u;for(n=60;n<=79;n++)u=d(i,5)+(r^a^s)+c+p[n]+3395469782&4294967295,c=s,s=a,a=d(r,30),r=i,i=u;m=m+i&4294967295,f=f+r&4294967295,g=g+a&4294967295,v=v+s&4294967295,w=w+c&4294967295}return(u=h(m)+h(f)+h(g)+h(v)+h(w)).toLowerCase()},utf8_encode:function(e){return encodeURIComponent(e)}},b=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a()(this,e),this.mlink=t}return c()(e,[{key:"init",value:function(e){this.data=e||{},this.getCustomStyles()}},{key:"getCustomStyles",value:function(){if(this.customStyles)return this.customStyles;var e,t={},n="custom_mp_data";if(this.data.custom_mp_data&&"{}"!==this.data.custom_mp_data?e=this.data.custom_mp_data:(e=this.data.custom_data,n=""),"string"==typeof e)try{e=JSON.parse(e)}catch(t){e={}}for(var o in n||(e.ios_json={bgUrl:e.iosBgUrl},e.android_json={bgUrl:e.androidBgUrl},e.open_app_json={bgUrl:e.link&&e.link.bgUrl,btnText:e.link&&e.link.openText,btnTextColor:e.link&&e.link.textColor,btnColor:e.link&&e.link.btnColor,btnDistanceBottom:"20%"},e.safari_down_json={bgUrl:e.link&&e.link.bgUrl,btnTextColor:e.link&&e.link.textColor,btnColor:e.link&&e.link.btnColor,btnDistanceBottom:"20%"},e.app_back_json={bgUrl:e.link&&e.link.bgUrl}),t.iosTipsImg=e.ios_json&&e.ios_json.bgUrl||"",t.androidTipsImg=e.android_json&&e.android_json.bgUrl||"",t.open_app_json=e.open_app_json||{},t.safari_down_json=e.safari_down_json||{},t.app_back_json=e.app_back_json||{},t.count_down_json=e.count_down_json||{},t)"iosTipsImg"!==o&&"androidTipsImg"!==o&&(t[o].type=n);return t.ios_wechat_json=e.ios_wechat_json||e.customMiddlePageIosWechatCommonJson||!1,t.open_app_json.btnDistanceBottom&&(/^[0-9]{1,2}\%$/.test(e.open_app_json.btnDistanceBottom)||(t.open_app_json.btnDistanceBottom="20%")),this.customStyles=t,t}},{key:"on",value:function(e,t,n){e&&t&&n&&(t&&t.constructor===Array?t:[t]).forEach((function(t){e.addEventListener(t,n)}))}},{key:"off",value:function(e,t,n){e&&t&&n&&(t&&t.constructor===Array?t:[t]).forEach((function(t){e.removeEventListener(t,n)}))}},{key:"hideAllPage",value:function(){var t=this;return new Promise((function(n){var o=document.querySelectorAll(".mw-page");e.each(o,(function(e){var o,i=["WebkitAnimationEnd","MozAnimationEnd","OAnimationEnd","MsAnimationEnd","animationEnd","animationend"],r=function r(){t.off(e,i,r),clearTimeout(o),n()};t.on(e,i,r),o=setTimeout(r,320),e.classList.remove("show"),e.classList.add("hide")}))}))}},{key:"showPage",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3?arguments[3]:void 0,i=o?document.querySelector(o+" "+e):document.querySelector(".mw-page"+e);if("custom_mp_data"===t.type&&t.bg)for(var r=i.querySelectorAll(".middle"),a=0;a<r.length;a++){var s=r[a].getAttribute("style");r[a].setAttribute("style",s+";display:none !important")}return this.renderPage(i,t,n),this.hideAllPage().then((function(){i&&(i.classList.add("show"),i.classList.remove("hide"))})),i}},{key:"renderPage",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};arguments.length>2&&void 0!==arguments[2]&&arguments[2];e&&(n.bg&&this.setBg(e,n.bg),n.title&&this.setTitle(e,n.title),n.text&&this.setText(e,n.text),n.tipsImg&&this.setTipsImg(e,n.tipsImg),n.appIcon&&this.setAppIcon(e,n.appIcon,n.appLogoIsShow),(n.productName||n.appName)&&this.setAppName(e,n),n.btn&&(Array.isArray(n.btn)&&n.btn.forEach((function(n){t.setBtn(e,n||{})})),this.setBtn(e,n.btn||{})),n.btn2&&this.setBtn(e,n.btn||{}))}},{key:"showDownloadTips",value:function(e){if(e.match(/:\/\/itunes\.apple\.com/)||e.match(/\.apk($|\?)/)){var t=this.data,n=t.productName||t.appName,o=t.iconUrl||t.appIcon;o+="?imageMogr/v2/thumbnail/300x300";var i=this.getCustomStyles().open_app_json||{},r='\n                <h3>正在等您安装</h3>\n                <div class="app-icon"><img id="appIcon" src="'.concat(o,'" alt="" onload="this.style.display=\'block\';" onerror="this.style.display=\'none\';"/></div>\n                <p><b onclick="window.location.reload();">').concat(n,'</b></p>\n\n                <br/>\n                <a class="mw-button no-margin" onclick="window.location.reload();">我已完成安装</a>\n                <div>如果您刚才不小心取消了安装, 请点击: </div>\n                <p>\n                </p>\n                <a class="mw-button no-margin min outline" href="').concat(e,'">再次安装</a>');this.showPage(".mw-alert",{text:r,btn:{color:i.btnTextColor||"",backgroundColor:i.btnColor||""},bg:i.bgUrl})}}},{key:"showSchemeNotSupport",value:function(e){var t=this.getCustomStyles();this.showPage(".scheme-notsupported",{appName:this.data.productName||this.data.appName,btn:{innerHTML:t&&t.safari_down_json&&t.safari_down_json.btnText,url:e}})}},{key:"showContentPage",value:function(e){var t=e.productName||e.appName,n=e.iconUrl||e.appIcon,o=e.mwContent,i=this.showPage(".custom-content",{appName:t,appIcon:n}),r=i.querySelector("h1"),a=i.querySelector(".mw-cc-banner"),s=a.querySelector("img"),c=i.querySelector(".content"),u=o.content||o.summary;return r.innerHTML=o.title,a.style.backgroundImage='url("'+o.contentImageUri+'")',s.src=o.contentImageUri,c.innerHTML=u,o.contentImageUri||(a.style.display="none"),i}},{key:"setBg",value:function(e,t){t?(e.style.backgroundImage='url("'+t+'")',e.classList.remove("default")):(e.style.backgroundImage="",e.classList.add("default"))}},{key:"setTipsImg",value:function(e,t){var n=e.querySelector(".tips");t?(n.style.backgroundImage='url("'+t+'") ',e.classList.remove("default")):(n.style.backgroundImage="",e.classList.add("default"))}},{key:"setTitle",value:function(e,t){var n=e.querySelector("h3");n&&(n.innerHTML=t)}},{key:"setText",value:function(e,t){var n=e.querySelector(".tips");n&&(n.innerHTML=t)}},{key:"setAppName",value:function(t,n){e.each(t.querySelectorAll(".app-name"),(function(e){e.innerHTML=n.productName||n.appName}))}},{key:"setAppIcon",value:function(t,n,o){n&&(n+="?imageMogr/v2/thumbnail/300x300"),e.each(t.querySelectorAll(".app-icon img"),(function(e){!1!==o?(e.parentElement.style.backgroundImage="none",e.setAttribute("src",n)):e.style.visibility="hidden"}))}},{key:"setBtn",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=n;e.each(t.querySelectorAll(o.btnName||".mw-button"),(function(e){o.backgroundColor&&(e.style.backgroundColor=o.backgroundColor),o.color&&(e.style.color=o.color),o.btnDistanceBottom&&(e.parentElement.style.bottom=o.btnDistanceBottom),n.innerHTML&&(e.innerHTML=n.innerHTML),n.initAction?n.initAction(e):(n.url&&(e.href=n.url),n.onclick&&(e.onclick=n.onclick))}))}},{key:"hidePage",value:function(e){var t=document.querySelector(e);t&&(t.classList.remove("show"),t.classList.add("hide"))}},{key:"appenStyle",value:function(e){var t=document.createElement("style");t.textContent=e,document.getElementsByTagName("head")[0].appendChild(t)}}],[{key:"each",value:function(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}}]),e}(),A=function(){function e(){a()(this,e)}return c()(e,null,[{key:"getCookie",value:function(e){var t=new RegExp("(^|;)[ ]*"+e+"=([^;]*)").exec(document.cookie);return t?decodeURIComponent(t[2]):null}},{key:"setCookie",value:function(e,t,n,o,i,r){var a;n&&(a=new Date).setTime(a.getTime()+n),document.cookie=e+"="+encodeURIComponent(t)+(n?";expires="+a.toGMTString():"")+";path="+(o||"/")+(i?";domain="+i:"")+(r?";secure":"")}}]),e}(),_=1,C=2,T=3,S=4,P=5,E=n(4);function x(e,t){var n="_qwertyuiopasdfghjklzxcvbnmQWERTYUIOPASDFGHJKLZXCVBNM1234567890+/=";e+="JMLINK",t=btoa(t);for(var o=e.length,i=t.length,r=n.length,a=1,s=0;s<o;s++)for(var c=(s+199)*e.substring(s,s+1).charCodeAt();c>r;)a+=c%r,c=parseInt(c/r);var u=[];for(s=0;s<i+6;s++){var l=n.indexOf(t.substring(s,s+1));u[s]||(u[s]=0),u[s]+=a*l}var d=-1;for(s=0;s<u.length-1;s++){(l=u[s])>0&&(d=s),l>=r&&(u[s+1]+=u[s]/r,u[s]=u[s]%r)}for(c="",s=0;s<=d;s++)c+=n.substring(u[s],u[s]+1);return c}var I=function(e,t){var n,o,i,r,a,s=!1;t||(t={}),n=t.debug||!1;try{if(o=E(),i=document.createRange(),r=document.getSelection(),(a=document.createElement("span")).textContent=e,a.style.all="unset",a.style.position="fixed",a.style.top=0,a.style.clip="rect(0, 0, 0, 0)",a.style.whiteSpace="pre",a.style.webkitUserSelect="text",a.style.MozUserSelect="text",a.style.msUserSelect="text",a.style.userSelect="text",a.addEventListener("copy",(function(e){e.stopPropagation(),t.onCopy&&(e.preventDefault(),t.onCopy(e.clipboardData))})),document.body.appendChild(a),function(e){var t;if("SELECT"===e.nodeName)e.focus(),t=e.value;else if("INPUT"===e.nodeName||"TEXTAREA"===e.nodeName){var n=e.hasAttribute("readonly");n||e.setAttribute("readonly",""),e.select(),e.setSelectionRange(0,e.value.length),n||e.removeAttribute("readonly"),t=e.value}else{e.hasAttribute("contenteditable")&&e.focus();var o=window.getSelection(),i=document.createRange();i.selectNodeContents(e),o.removeAllRanges(),o.addRange(i),t=o.toString()}}(a),!document.execCommand("copy"))throw new Error("copy command was unsuccessful");s=!0}catch(o){n&&console.error("unable to copy using execCommand: ",o),n&&console.warn("trying IE specific stuff");try{window.clipboardData.setData("text",e),t.onCopy&&t.onCopy(window.clipboardData),s=!0}catch(e){n&&console.error("unable to copy using clipboardData: ",e)}}finally{r&&("function"==typeof r.removeRange?r.removeRange(i):r.removeAllRanges()),a&&document.body.removeChild(a),o()}return s};function L(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:6,t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",n="",o=e;o>0;--o)n+=t[Math.floor(Math.random()*t.length)];return n}var D=function(e,t){var n=/^(192\.168\.|169\.254\.|10\.|172\.(1[6-9]|2\d|3[01]))/,o=/([0-9]{1,3}(\.[0-9]{1,3}){3})/,i=/[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7}/,r=!1;if(["RTCPeerConnection","webkitRTCPeerConnection","mozRTCPeerConnection","RTCIceGatherer"].forEach((function(e){r||e in window&&(r=!0)})),!r)return y("webRTC is not supported"),void e();var a=!0,s=!0;!function(e,t){if("undefined"!=typeof document&&"function"==typeof document.getElementById){var i={},r=window.RTCPeerConnection||window.mozRTCPeerConnection||window.webkitRTCPeerConnection;if(!r){var a=document.getElementById("iframe");if(!a)return;var s=a.contentWindow;r=s.RTCPeerConnection||s.mozRTCPeerConnection||s.webkitRTCPeerConnection}if(r){var c=new r({iceServers:[]});if(t&&(c.addStream?c.addStream(t):c.addTrack&&t.getTracks()[0]&&c.addTrack(t.getTracks()[0],t)),c.onicecandidate=function(e){e.candidate&&e.candidate.candidate?u(e.candidate.candidate):u()},!t)try{c.createDataChannel("jmlink",{})}catch(e){}c.createOffer().then((function(e){c.setLocalDescription(e).then(l)}))}}function u(t){if(t){var r=o.exec(t);if(r){var a=r[1],s=t.match(n);void 0===i[a]&&e(a,s,!0),i[a]=!0}}else e()}function l(){c.localDescription.sdp.split("\n").forEach((function(e){e&&0===e.indexOf("a=candidate:")&&u(e)}))}}((function(t){t?t.match(n)?e(t,a=!1,s):t.match(i)?e(t,a,s=!1):e(t,a,s):e()}),t)},j=n(2),R=n.n(j);function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N,M=b,B=A,q=m,V=p,W=u,H=w,F=y,X=k,G=I,Y=window.navigator.userAgent,K=X.sha1(Y),z=[],Q={},J={},$=localStorage,Z=[];function ee(e){return!!e&&e.constructor===Array}function te(e,t){for(var n=0;n<e.length;n++)t(e[n],n)}var ne=function(){function e(){a()(this,e);for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];var i=this.formatConfig(n),r=i.autoInit;this.jsonData={},this.config=i.config,this.isAutoRedirect=i.config.isAutoRedirect,this.autoUl=i.config.autoUl,this.render=new M(this),this.clueType=_,this.wakeId=L(),!1!==r&&this.init()}return c()(e,[{key:"setClueType",value:function(e){e&&(this.clueType=e)}},{key:"subDomainCheck",value:function(e){var t=e.jmlink,n=new m(t);return e.jmlink=n.toString(),e.domainUrl=t,e}},{key:"init",value:function(){F("jmlink init");var t,n=this.config;if(ee(n))te(n=ee(n)?n:[n],(function(n){!0!==(void 0!==n.autoLaunchApp?n.autoLaunchApp:n.autoRedirect)||t?(n.autoLaunchApp=!1,new e(n)):(t=!0,new e(n))}));else if(!0===this.checkConfig(n)){var o=(n=this.subDomainCheck(n)).button;if(o&&(o.constructor===Array||o.constructor===NodeList)){var i=[];te(o,(function(e){e&&(e.tagName&&i.push(e),e.constructor===NodeList&&te(e,(function(e){i.push(e)})))})),n.button=i}this.trackingH5(n.jmlink,!1),this.initButton(n);var r=void 0!==n.autoLaunchApp?n.autoLaunchApp:n.autoRedirect;!0===r&&("shorturl"===e.env.model?(F("autoLaunchApp: ",r),this.redirect(n)):e.location(this.applyParamsToShorturl(n.domainUrl)))}}},{key:"formatConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={},n=e.length,o=[];return e.forEach((function(e,i){i!==n-1||"boolean"!=typeof e?e&&e.constructor===Object?o.push(e):e&&e.constructor===Array&&(o=e):t.autoInit=e})),1===o.length&&o[0].constructor===Object&&(o=o[0]),t.config=o,t}},{key:"checkConfig",value:function(e){return e.jmlink&&e.button?(e.jmlink.match(/^https?/)||(e.jmlink=window.location.origin+"/"+e.jmlink.replace(/(^[\/\s]*)/,"").replace(/[\s\/]*$/,"")),!0):(console.log("new JMLink([{"),e.jmlink?console.log('    "jmlink" : "'+e.jmlink+'",'):console.error('  "jmlink" : "{xxxx}", // 短链KEY是必要参数, 不能为空.'),e.button?console.log('    "button" : "a标签(DOM类型)"'):console.error('  "button" : "DOM类型, 您页面中打开App的链接." // 必要参数, 不能为空'),console.log("}]);"),!1)}},{key:"initButton",value:function(t,n){var o=this,i=t.button&&"number"==typeof t.button.length?t.button:[t.button],r=n?"number"==typeof n.length?n:[n]:null;r=r&&r.length>0?r:i;for(var a,s=!!new q(t.jmlink).getParam("DO_NOT_TRACKING")||"open"===e.env.model,c=0,u=r.length;c<u;c++){if((a=r[c])&&"function"==typeof a.setAttribute)if(!a.getAttribute("mlink-handling")){a.setAttribute("href","javascript:void(0)");a.onclick=function(){F("default redirect"),o.tracking(!0),"function"==typeof t.beforeClick&&t.beforeClick(),o.redirect(t,!0)}}}this.loadData(null,null,{doNotTracking:s}).then((function(n){var i=o.config.jmlink;n=o.mwToApp(n);var a=o.getUniversalLink(n),s=H.isSupportedUniversalLink(n)&&a&&!0!==o.config.inapp,c=V.ios?n.iosLink:n.androidLink,u=c&&H.isSupportedSchemeOnlyClick(n),l=s?a:c,d=o.getDownloadUrl(n);if(l=o.passParamsToApp(l),s){var h=new q(l);l=h.toString(),o.setClueType(P)}else o.setClueType(C);var p=H.qq&&H.qqVersion[0]>=6;if("open"===e.env.model&&(u||s)&&!H.qq||(V.ios&&V.iosVersion[0]<9||V.android)&&p){F("open: ",l),o.sendEvent(l);for(var m=function(){if(o.tracking(!0),o.sendEvent(l,!0),"function"==typeof t.beforeClick&&t.beforeClick(),setTimeout((function(){document.location.href=l}),600),!(s&&V.ios&&V.iosVersion[0]>=9&&p)&&u){var r=setTimeout((function(){if(H.isSupportedYYB(n,i))o.setClueType(n.yybDownloadUrl?S:T),o.openDownloadUrl(n.yybDownloadUrl||d,"yyb");else if("open"===e.env.model&&(H.wx||H.weibo)){var t=new q(o.config.domainUrl),r=!1;!0===o.config.resetWeixinMenu&&(t.setParam("resetWeixinMenu",1),r=r||!t.getParam("resetWeixinMenu")),!0===o.config.preventDownload&&(t.setParam("preventDownload",1),r=r||!t.getParam("preventDownload")),r?e.location(t.toString()):(o.setClueType(T),o.openDownloadUrl(d))}else o.openDownloadUrl(d)}),1e3);o.onAppLaunched((function(){clearTimeout(r)}))}},f=0,g=r.length;f<g;f++){var v=r[f],w=v.getAttribute("mlink-handling");v&&"function"==typeof v.setAttribute&&!w&&(v.setAttribute("mlink-handling",!0),V.ios&&V.iosVersion[0]<9&&p||V.ios&&V.iosVersion[0]>=9&&p&&!s?(v.setAttribute("href",o.passParamsToApp(c)),v.addEventListener("click",m)):(v.setAttribute("href","javascript:void(0)"),v.onclick=function(){},v.removeEventListener("click",m),v.addEventListener("click",m)))}}else if(V.ios&&V.iosVersion[0]>=9&&p)for(var y=0,k=r.length;y<k;y++){var b=r[y];b.setAttribute("mlink-handling",!0),b.setAttribute("href",o.passParamsToApp(c)),o.sendEvent(c),b.onclick=function(){o.tracking(!0),o.setClueType(s?P:C),o.sendEvent(c,!0);var t=setTimeout((function(){if(H.isSupportedYYB(n,i))o.setClueType(n.yybDownloadUrl?S:T),o.openDownloadUrl(n.yybDownloadUrl||d);else if("open"===e.env.model&&(H.wx||H.weibo)){var t=new q(o.config.domainUrl),r=!1;!0===o.config.resetWeixinMenu&&(t.setParam("resetWeixinMenu",1),r=r||!t.getParam("resetWeixinMenu")),!0===o.config.preventDownload&&(t.setParam("preventDownload",1),r=r||!t.getParam("preventDownload")),r?e.location(t.toString()):(o.setClueType(T),o.openDownloadUrl(d))}else o.setClueType(T),o.openDownloadUrl(d)}),1e3);return o.onAppLaunched((function(){clearTimeout(t)})),!0}}else"open"===e.env.model&&o.sendEvent(c)}))}},{key:"redirect",value:function(t,n){var o=this;F("redirect isClick: ",n);var i=this.config.jmlink;if(V.desktop)this.showQrCode();else{var r=!!new q(t.jmlink).getParam("DO_NOT_TRACKING")||"open"===e.env.model;this.loadData(null,null,{doNotTracking:r}).then((function(r){F("load data end！"),r=o.mwToApp(r),o.resetTitle(r.productName);var a=new q(i),s=V.android?r.androidLink:r.iosLink,c=o.getDownloadUrl(r),u=o.isAppInstalled(),l=o.getUniversalLink(r);o.customDataView="1"===a.getParam("mw_preview")&&r.mwContent,o.applink=s,o.MW_ST=+new Date,o.MW_TQ=[],o.MW_TQ_TICKET=setInterval((function(){o.MW_TQ.push(0)}),100);var d=H.isSupportedUniversalLink(r)&&!l;if(s||!d){if(H.isSupportedUniversalLink(r)&&l&&!0!==o.config.inapp)return F("ul."),l=o.passParamsToApp(l),l=new q(l).toString(),o.applink=l,void(n?(F("byClick: ",n),o.setClueType(P),o.sendEvent(l,n).then((function(){H.wx&&"open"===e.env.model&&(setTimeout((function(){window.location.reload()}),1e3),$&&$.setItem("mwDoNotTracking",o.config.jmlink))})),o.location(l,(function(){}),600)):(o.setClueType(P),o.sendEvent(l),o.showUniversalLinkButton(l)));var h=!1;H.qq&&H.qqVersion[0]>=6&&"open"!==e.env.model&&(h=!0),(H.qqbrowser||H.qzone)&&(h=!0);var p=H.isSupportedYYB(r,i);if(p&&(c=r.yybDownloadUrl||c),F("isSupportedYYB: ",!h),p&&!h)return F("YYB2 Event."),o.setClueType(S),void o.sendEvent(s,!0,1).then((function(){F("Redirect to YYB."),setTimeout((function(){o.location(c)}),600)}));if(F("click scheme"),F("byClick "+n),!n&&H.isSupportedSchemeOnlyClick(r))return F("supported scheme by click"),o.sendEvent(s,n),void o.showSchemeButton(s);if(H.wx||H.qq||H.weibo||V.android&&H.qzone){if(F("wx | qq | weibo."),o.sendEvent(s,n),!H.isSupportedSchemeOnlyClick(r)){if("open"===e.env.model){var m=new q(o.applyParamsToShorturl(t.domainUrl));return!0===t.resetWeixinMenu&&m.setParam("resetWeixinMenu",1),!0===t.preventDownload&&m.setParam("preventDownload",1),void(window.location.href=m.toString())}if(F("isSupportedSchemeOnlyClick else"),n||new q(t.jmlink).getParam("DO_NOT_TRACKING")+""=="1"){if(F("byClick else"),H.wx&&(V.android||V.iosVersion[0]<9)&&H.isSupportedYYB(r,i))return void o.sendEvent(s,!0,1).then((function(){F("Redirect to YYB."),setTimeout((function(){o.location(c)}),500)}));o.createOpenInBrowserModal(!0)}else{if(F("byClick else href"),new q(o.applyParamsToShorturl(t.domainUrl)).setParam("DO_NOT_TRACKING",1),H.wx&&(V.android||V.iosVersion[0]<9)&&H.isSupportedYYB(r,i))return o.setClueType(S),void o.sendEvent(s,!0,1).then((function(){F("Redirect to YYB."),setTimeout((function(){o.location(c)}),500)}));o.createOpenInBrowserModal(!0)}return}if(F("isSupportedSchemeOnlyClick"),n)return F("byClick: ",n),void o.openScheme(s,(function(){"open"===e.env.model?window.location.href=o.applyParamsToShorturl(t.domainUrl):H.qq?(o.setClueType(T),o.openDownloadUrl(c)):o.createOpenInBrowserModal()}),600)}if(H.isSupportedScheme(r))return F("default for scheme: "+s),o.sendEvent(s,n),void setTimeout((function(){F("isAppInstalled:"+u),!0===u?o.openScheme(s,(function(){o.render.showSchemeNotSupport(c)}),500):!1===u?(o.setClueType(T),o.openDownloadUrl(c,!0,s)):o.openScheme(s,(function(){F("Redirect to Download URL.1"),o.setClueType(T),o.openDownloadUrl(c,!1,s)}),500)}),500);F("not support scheme."),o.sendEvent(s,n),o.render.showSchemeNotSupport(c)}else{if(F("!scheme && noUniversalLink:"+!s+"-"+d),(!H.isSupportedSchemeOnlyClick(r)||n)&&"LANDING_PAGE"===r.jumpType&&r.landingPage)F("goto landing page.."),e.location(r.landingPage);else{F("setting error.");var f=V.ios?"iOS":"Android",g="很抱歉，"+r.productName+"暂未提供"+f+"对应的跳转服务。";o.render.showPage(".setting-error",{title:g,text:" "})}}}))}}},{key:"loadData",value:function(t,n){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=6e3,a=this,s=this.config,c=s.timeout||r,u=s.timeoutCallback||function(){a.render.showPage(".server-error")};(isNaN(+c)||+c<0)&&(c=r,console.warn("timeout  must be number and >0")),"function"!=typeof u&&(u=function(){a.render.showPage(".server-error")},console.warn("timeoutCallback must be function")),n=n||this.config.jmlink,n=this.applyParamsToShorturl(n);var l=this.getApiHost(n);if($&&$.getItem("mwDoNotTracking")===n&&(i.doNotTracking=!0,$.setItem("mwDoNotTracking","")),!0!==i.doNotTracking&&delete i.doNotTracking,H.mw){var d=H.magicWindowConfig&&H.magicWindowConfig.ak;d&&(i.inAk=d)}if(J[n]&&!0!==t)return new Promise((function(e){e(J[n])}));if(Q[n]&&!0!==t){var h=Q[n];return this.jsonData=h.result,h}return Q[n]=new Promise((function(t,i){var r=new XMLHttpRequest,a=setTimeout((function(){console.warn("time out"),u(s),i()}),c);r.onreadystatechange=function(){if(4==r.readyState){if(200==r.status){clearTimeout(a);var s=o.parseJson(r.responseText);if(s&&o.render.init(s),o.jsonData=s,s.ssd){var c=o.getShorturlKey(n);o.config.jmlink=e.env.protocol+s.ssd+"/"+c,o.config.domainUrl=o.config.jmlink,F("jmlink ssd: ",o.config.domainUrl)}if(!0===o.config.preventDownload&&s.ios9Link){var u=new q(s.ios9Link);s.ios9Link=u.setParam("preventDownload","1").toString()}if(o.config.sendDpEventWhenLoading){var l=V.ios?s.iosLink:s.androidLink,d=H.isSupportedUniversalLink(s)?s.ios9Link:l;o.sendEvent(d)}J[o.config.jmlink]=s,t(s)}else o.render.showPage(".server-error"),i();delete Q[n]}},r.open("GET",l,!0),r.setRequestHeader("Content-Type","application/json;charset=UTF-8"),r.send(null)})),Q[n]}},{key:"sendEvent",value:function(t,n){var o=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];F("sendEvent");var s=this.jsonData||{},c=this.getEventUrl(null),u=V.ios?1:(V.android,0),l=1===u?Y.match(/iPhone OS ([\d_\.]*)/):Y.match(/Android ([\d_\.]*)/),d=this.getShorturlKey(),h=W.getScreenResolution(),p=s.resX||h.width,m=s.resY||h.height,f=r||s.staticParams||"{}",g=this.jsonData.appKey,v=(new Date).getTime(),w=this.jsonData.sceneRecoveryTime||0;if(n&&w>0){var y=v+60*w*1e3;F("overTime: ",y);try{var k=this.passParamsToApp(t);k+="&mw_ot=".concat(y),F("copy text:",g);var b="[".concat(x(g,k),"]");G(b)}catch(e){console.log(e)}}return e.createLocalIP(n).then((function(){return e.createFingerId()})).then((function(e){var s={ak:o.jsonData.appKey,os:u,osv:l?(l[1]||"").replace(/_/g,"."):"",sr:[p,m].join("x"),dp:a?o.passParamsToApp(t):t,k:d,yyb:i,dt:JSON.parse(f),dpr:window.devicePixelRatio||1,t:v,localIP:Z,memory:navigator.deviceMemory?1024*navigator.deviceMemory:null,fp:e,ct:o.clueType,wakeId:o.wakeId};return F("send event start"),F("sending event: ",s),1===i&&o.sendEvent(t,n,0,r,a),o.httpReport("POST",c,s)}))}},{key:"applyParamsToShorturl",value:function(e,t){var n=[],o=this.config.plhparams||{};for(var i in o)n.push(i+"="+encodeURIComponent(o[i]));t&&(n.push("noautoredirect=true"),n.push("mw_source="+encodeURIComponent(location.href)));var r=this.config.params||{};for(var a in r)n.push("mw_cp_"+a+"="+encodeURIComponent(r[a]));var s=this.config.invtparams||{};for(var c in s)n.push("mw_dynp_"+c+"="+encodeURIComponent(s[c]));return(n=n.sort()).length>0&&(e+=(-1===e.indexOf("?")?"?":"&")+n.join("&")),e}},{key:"passParamsToApp",value:function(t){if(t&&-1==t.indexOf("mw_mk=")){var n=this.jsonData?this.jsonData:{},o=[],i=new q(this.config.jmlink),r=i.getParam("mw_ck"),a=i.getParam("mw_dc_order"),s=i.getParam("mw_dc"),c=i.getParam("mw_ios_dc"),u=i.getParam("mw_android_dc");r&&r.match(/(%\w{2})+/g)&&(r=decodeURIComponent(r)),s&&s.match(/(%\w{2})+/g)&&(s=decodeURIComponent(s)),c&&c.match(/(%\w{2})+/g)&&(c=decodeURIComponent(c)),u&&u.match(/(%\w{2})+/g)&&(u=decodeURIComponent(u)),o.push(["mw_ck",encodeURIComponent(r||n.channel||"")].join("=")),o.push(["mw_dc",encodeURIComponent(s||"")].join("=")),o.push(["mw_dc_order",encodeURIComponent(a||"")].join("=")),o.push(["mw_ios_dc",encodeURIComponent(c||"")].join("=")),o.push(["mw_android_dc",encodeURIComponent(u||"")].join("=")),o.push(["mw_mk",encodeURIComponent(n.mLinkKey||"")].join("=")),o.push(["mw_slk",encodeURIComponent(this.getShorturlKey()||"")].join("=")),o.push(["mw_tags",encodeURIComponent(n.tags||"")].join("=")),o.push(["mw_wid",this.wakeId].join("="));var l=this.config.params;for(var d in l||(l=i.getParamsStartWith("mw_cp_")||{}),l){var h="mw_cp_"+d;-1==t.indexOf(h)&&o.push([h,encodeURIComponent(l[d])].join("="))}var p=new e.Uri(location.href).getParams();for(var m in p)-1==t.indexOf(name)&&o.push(m+"="+encodeURIComponent(p[m]));var f=this.config.invtparams;for(var g in f||(f=i.getParamsStartWith("mw_dynp_")||{}),f){var v="mw_dynp_"+g;-1==t.indexOf(v)&&o.push([v,encodeURIComponent(f[g])].join("="))}o.push(["mw_tk",encodeURI(K)].join("=")),o.push(["mw_ak",n.appKey].join("=")),o=o.join("&"),t=(t=t+(-1===t.indexOf("?")?"?":"&")+o).replace(/REQUEST_TYPE=(\w+)(&|$)/,"").replace(/&$/,"")}return t}},{key:"getApiHost",value:function(t){var n="?"+new q(t).queryString,o=e.env.protocol+e.env.ulHost+"/jmlink-share/"+e.env.av+"/open/"+this.getShorturlKey(t)+n;return new q(o).toString()}},{key:"getUniversalLink",value:function(e){if(e){var t=new q(e.ios9Link||e.universalLink);return H.magicWindowConfig,!1!==this.config.downloadWhenUniversalLinkFailed&&(t.setParam("downloadWhenFailed","1"),e.ios9Link=t.toString()),!0===this.config.resetWeixinMenu&&t.setParam("resetWeixinMenu",1),t.toString()}}},{key:"createOpenInBrowserModal",value:function(e){var t=this,n={},o={},i=V.ios?".openinbrowser.ios":".openinbrowser.android",r=this.jsonData||{},a=r.iconUrl,s=this.render.getCustomStyles(),c=V.ios?s.iosTipsImg:s.androidTipsImg;V.iosVersion[0]>=9&&H.wx&&!e&&(i=".openinbrowser-ios9-wechat",s.ios_wechat_json&&(c=s.ios_wechat_json.bgUrl,!1===s.ios_wechat_json.appLogoIsShow&&(a=!1),o.appLogoIsShow=s.ios_wechat_json.appLogoIsShow,!1===s.ios_wechat_json.appNameIsShow?o.appName=!1:(o.appName=r.productName,s.ios_wechat_json.appNameColor&&(o.appNameColor=s.ios_wechat_json.appNameColor)),n.innerHTML=s.ios_wechat_json.btnText||"立即下载",n.backgroundColor=s.ios_wechat_json.btnColor||"#69f",n.color=s.ios_wechat_json.btnTextColor||"#fff"),n.onclick=function(){t.sendEvent(r.iosLink,!0,1).then((function(){t.location("LANDING_PAGE"===r.jumpType?r.landingPage:r.iosDownloadUrl)}))});var u=this.render.showPage(i,U({appIcon:a},o,{btn:U({},n)}));u&&this.render.setTipsImg(u,c)}},{key:"parseJson",value:function(e){try{var t=JSON.parse(e);return t=t&&t||{}}catch(e){return""}}},{key:"getProtocol",value:function(e){var t=e.match(/^(\w+):\/\//);if(t)return t[1]}},{key:"getDownloadUrl",value:function(e){(this.jsonData.iosDownloadUrl||this.jsonData.androidDownloadUrl)&&(e=this.jsonData);var t,n=e.landingPage,o=V.ios?e.iosDownloadUrl:e.androidDownloadUrl,i="";n&&(t=new q(this.config.jmlink).getParams(),i=new q(n).setParams(t).toString());return"LANDING_PAGE"===e.jumpType?i:o}},{key:"getEventUrl",value:function(t){return(t||(this.jsonData?this.jsonData.server:"")||e.env.protocol+e.env.ulHost)+"/jmlink-share/"+e.env.av+"/share/event"}},{key:"getScreenResolution",value:function(){var e,t=window.screen;return e=V.ios||H.wx||H.uc||!window.devicePixelRatio?1:window.devicePixelRatio,[t.width*e,t.height*e].join("x")}},{key:"getShorturlKey",value:function(e){var t=e||this.config.jmlink,n=new q(t).path.split("/");return n=n[n.length-1]}},{key:"httpReport",value:function(e,t,n){return new Promise((function(o,i){var r;(r=new XMLHttpRequest)&&(r.open(e,t,!0),r.withCredentials=!0,r.setRequestHeader("Method",e+" "+t+" HTTP/1.1"),r.setRequestHeader("Content-type","application/json"),"POST"==e?r.send(JSON.stringify(n)):r.send(),r.onreadystatechange=function(){4===parseInt(r.readyState)&&(200===parseInt(r.status)?o():i())}),setTimeout((function(){o()}),2e3)}))}},{key:"trackingH5",value:function(t,n){var o=e.env.protocol+e.env.trackEvent+"/jmlink-tracking/"+e.env.av+"/tracking/i";o+="open"==e.env.model?"?ch=cst":"?ch=dft";var i=this.getShorturlKey();o+="&cid="+i,o+=1==n?"&action=clk":"&action=exp";var r=(new Date).getTime()+Math.floor(1e13*Math.random());o+="&rdm="+r;var a=new Image;a.onerror=function(){(new Image).src=o},setTimeout((function(){a.src=o}),0)}},{key:"tracking",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this.btnClickedCounter=this.btnClickedCounter||0,(this.btnClickedCounter>0||e)&&this.trackingH5(this.config.jmlink,!0),this.btnClickedCounter+=1}},{key:"trackingDownload",value:function(){}},{key:"getDeferredTime",value:function(){var e=(+new Date-this.MW_ST)/1e3-this.MW_TQ.length/10;return clearInterval(this.MW_TQ_TICKET),e}},{key:"openDownloadUrl",value:function(t,n,o){var i=this;if(t){var r=new q(document.location.href);if(!0!==this.config.preventDownload&&!r.getParam("preventDownload")){var a=this.render.getCustomStyles().count_down_json||{},s=this.jsonData.iconUrl,c=document.querySelector(".mw-page.scheme-redirecting");c&&!c.classList.contains("show")&&this.render.showPage(".scheme-redirecting",{bg:a.bgUrl,appIcon:s,appLogoIsShow:a.schemeLogoShow,appName:a.schemeAppNameShow?this.jsonData.productName:"",appNameColor:a.schemeAppNameColor,btn:[{btnName:".mw-open-app",backgroundColor:a.schemeOpenBtnColor,color:a.schemeOpenTextColor,innerHTML:a.schemeOpenBtnText||"打开app"},{btnName:".mw-open-download",backgroundColor:a.schemeLoadBtnColor,color:a.schemeLoadTextColor,innerHTML:a.schemeLoadBtnText||"下载app",onclick:function(){i.sendEvent(o,!0).then((function(){setTimeout((function(){F("downloadURL: ",t),window.top.location.href=t}),500)}))}}]}),"open"===e.env.model&&e.location(this.applyParamsToShorturl(this.config.domainUrl,!((9===V.iosVersion[0]||10===V.iosVersion[0])&&H.safari))),t.match(/app\.qq\.com/)&&H.wx&&e.location(t),t.match(/:\/\/itunes\.apple\.com/)||t.match(/\.apk($|\?)/)||this.onAppLaunched((function(){F("Not APK & AppStore.")}))}}else{var u=V.ios?"当前服务无苹果版本":"当前服务无安卓版本";this.render.showPage(".server-error",{title:u,text:" "})}}},{key:"isAppInstalled",value:function(){var e=window.location.href,t=new q(e),n="weixin"===t.getParam("platform"),o="1"===t.getParam("isappinstalled");return n?!!o:"unknow"}},{key:"isPageVisible",value:function(){return!(void 0!==document.hidden?document.hidden:void 0!==document.mozHidden?document.mozHidden:void 0!==document.msHidden?document.msHidden:void 0!==document.webkitHidden?document.webkitHidden:void 0!==window.JSInterface&&!window.JSInterface.mwAppOpened())}},{key:"getParam",value:function(e){var t=window.document.location.href.match(new RegExp("[?&]"+e+"=(\\w*)[&$]"));return t?t[1]:""}},{key:"onAppLaunched",value:function(e){var t=this;e="function"==typeof e?e:function(){},F("onAppLaunched");window.addEventListener("beforeunload",(function(e){F(e.type)}));var n=!1,o=function(o){if(N&&clearInterval(N),!n){n=!0;var i=o.type;F("event",i),"webkitvisibilitychange"===i&&t.isPageVisible()||e();var r=t.getDownloadUrl(t.jsonData);t.openDownloadUrl(r)}};window.addEventListener("pagehide",o),window.addEventListener("unload",o),document.addEventListener("webkitvisibilitychange",o),document.addEventListener("visibilitychange",o),document.addEventListener("qbrowserVisibilityChange",o)}},{key:"openScheme",value:function(t,n,o){if(F(V.ios+";"+V.ipad+V.iosVersion[0]),this.isAutoRedirect)return this.isAutoRedirect=!this.isAutoRedirect,n();if("open"===e.env.model&&(9===V.iosVersion[0]||10===V.iosVersion[0])&&H.safari)return n();var i=n,r=H.mw&&H.mwVersion,a=!1;r&&(r[0]>=4||3==r[0]&&r[1]>9||3==r[0]&&9==r[1]&&r[2]>161125)&&(a=!0),V.ios&&V.iosVersion[0]>=9&&a?(F("Scheme with magicwindow."),this.openAppWithMagicwindow(t,i,o)):V.ios&&V.iosVersion[0]>=9&&!a?(F("Scheme with location."),this.location(t,i,o)):H.huawei&&!H.chrome?(F("Scheme with iframe."),this.openAppWithIframe(t,i,o)):V.android&&H.chrome?(F("Scheme with location."),this.location(t,i,o)):V.ios&&H.chrome?(F("Scheme with window.open."),this.openAppWithWindowOpen(t,i,o)):this.location(t,i,o)}},{key:"openAppWithWindowOpen",value:function(e,t,n){var o;e=this.passParamsToApp(e);try{o=window.open(e)}catch(e){}o?window.close():t()}},{key:"openAppWithMagicwindow",value:function(e,t,n){var o=this,i=setTimeout(t,n||500);e=this.passParamsToApp(e),window.MW_APP_OPEND_CALLBACK_FN=function(e){if(F("MW_APP_OPEND_CALLBACK_FN:"+e),+e){var t=o.getDownloadUrl(o.jsonData);o.openDownloadUrl(t),clearTimeout(i)}},webkit&&webkit.messageHandlers&&webkit.messageHandlers.MagicWindow&&webkit.messageHandlers.MagicWindow.postMessage({method:"mwOpenUrl",data:JSON.stringify({urlScheme:e,callback:"MW_APP_OPEND_CALLBACK_FN"})})}},{key:"location",value:function(t,n,o){t=this.passParamsToApp(t),e.location(t);var i=setTimeout(n,o||500);this.onAppLaunched((function(){clearTimeout(i)}))}},{key:"showSchemeButton",value:function(e){this.showRedirectButton(e,0)}},{key:"showUniversalLinkButton",value:function(e){this.showRedirectButton(e,1)}},{key:"showRedirectButton",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t||this.config.button,o=J[this.config.jmlink]||{},i=o.productName||o.appName,r=o.iconUrl||o.appIcon,a=this.render.getCustomStyles(),s=a.open_app_json;n&&(n.constructor!==Array&&(n=[n]),this.initButton(this.config,n)),null===t&&this.render.showPage(".redirect-with-button",{appIcon:r,appName:i,type:s.type,bg:s.bgUrl,btn:{innerHTML:s.btnText||"打开App",color:s.btnTextColor||"",backgroundColor:s.btnColor||"",btnDistanceBottom:s.btnDistanceBottom||"20%",href:H.aliPay&&e}})}},{key:"resetTitle",value:function(e){}},{key:"showQrCode",value:function(){var t=this,n="//"+e.env.ulHost+"/jmlink-share/"+e.env.av+"/gr/gen"+("?margin=0&width=150&content="+encodeURIComponent(this.config.jmlink));setTimeout((function(){t.render&&t.render.showPage(".mw-alert",{title:"请扫描二维码在移动设备上访问",text:'<img class="qrcode-img" src="'.concat(n,'">')})}),30)}},{key:"openAppWithIframe",value:function(e,t,n){e=this.passParamsToApp(e);var o=document.createElement("iframe");o.style.width="0px",o.style.height="0px",o.style.overflow="hidden",o.id="mlinkIframeLauncher",o.src=e,document.body.appendChild(o);var i=setTimeout(t,n||500);this.onAppLaunched((function(){clearTimeout(i)}))}},{key:"mwToApp",value:function(e){if(!H.mw)return e;var t={mw_mlink_k:"webview"};t.mw_mlink_appid=H.magicWindowConfig&&H.magicWindowConfig.ak,t.mw_aba_appName=e.inProductName,t.mw_mlink_cb=e.inScheme;var n=e.ios9Link&&new q(e.ios9Link),o=e.iosLink&&new q(e.iosLink);for(var i in t)t[i]&&(n&&n.setParam(i,t[i]),o&&o.setParam(i,t[i]));return e.ios9Link=n?n.toString():"",e.iosLink=o&&o.toString(),e}}],[{key:"location",value:function(e){e&&(document.location.href=e)}},{key:"isIosLE9",value:function(){return V.ios&&V.iosVersion[0]>=9}},{key:"loadScript",value:function(){for(var e=[],t=document.querySelector("head"),n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return o.forEach((function(n){var o=document.createElement("script"),i=new Promise((function(e,n){o.onload=function(){e(),t.removeChild(o)},o.onerror=function(){n(),t.removeChild(o)}}));o.src=n,t.appendChild(o),e.push(i)})),Promise.all(e)}},{key:"ready",value:function(e){var t=document.readyState;"interactive"===t||"complete"===t?e():(z.push(e),document.addEventListener("readystatechange",(function(){var e;if("interactive"===(t=document.readyState)||"complete"===t)for(;z.length>0;)"function"==typeof(e=z.shift())&&e()})))}},{key:"createLocalIP",value:function(e){return new Promise((function(t,n){if(e)try{D((function(e,n,o){e&&!n&&o&&(F("ip: ",e),Z.includes(e)||Z.push(e)),t(Z)}))}catch(e){t(Z)}else t(Z)}))}},{key:"createFingerId",value:function(){return new Promise((function(e,t){var n="mw_fingerId",o=window.localStorage.getItem(n)||"";o?e(o):R.a.get((function(i){var r=i.map((function(e){return e.value}));(o=R.a.x64hash128(r.join(""),31))?(window.localStorage.setItem(n,o),e(o)):t(o)}))}))}},{key:"scanLink",value:function(){if("shorturl"!==e.env.model){var t=1;N=setInterval((function(){te(document.querySelectorAll("a[data-jmlink]"),(function(n){var o=n.getAttribute("href"),i=!!n.getAttribute("data-jmlink"),r=n.getAttribute("data-jmlink-scan"),a="true"===n.getAttribute("data-auto"),s=n.getAttribute("data-params");o&&(o=new q(o)),s&&(s=(s=s.slice(1,-1).split(",")).map((function(e){return e.split(":").map((function(e){return e.trim()}))})).reduce((function(e,t){return e[t[0]]=t[1],e}),{})),i&&o&&o.host&&!r&&(n.setAttribute("data-jmlink-scan",t),console.log("scanlink: ",t),t+=1,new e({jmlink:o.toString(),button:n,autoLaunchApp:a,params:s}))}))}),600)}}}]),e}();ne.Cookie=B,ne.os=V,ne.Uri=q,ne.browser=H,ne.debug=F,ne.device=W,ne.Render=M,ne.Version="1.1.5",ne.env={prefix:"jmlk.co",ulHost:"share-jmlink.jpush.cn",env:"prod",model:"open",av:"v1",trackEvent:"tracking-jmlink.jpush.cn",protocol:"https://"},ne.scanLink(),window.JMLink=ne;t.default=ne}]);